---
title: "R for Demographic Data Analysis"
---

R is a statistical programming language that can be used for everything from importing data to automating repetitive analysis workflows to creating publication ready data visualizations including maps. It can also be used to build interactive data visualizations and web apps.

This demo shows how to use R to pull data from the Census API, explore the data in table and map form, and export to a shapefile that can be used to create publication-ready maps in ArcGIS.

## Loading required R packages
R comes preloaded with many useful functions for statistical analysis, but much more functionality is available through extensions called packages that are developed by other R users. 

You only need to install each package once on your computer, but whenever you are writing code in R you will have to load the relevant packages with the library() function.

```{r}
#|output: false
library(tidycensus)
library(tigris)
library(tidyverse)
library(sf)
library(mapview)
```

We have loaded several helpful packages:
`tidycensus` contains functions for downloading datasets directly from the Census Bureau API, including associated geometries.
`tigris` can be used to download census geometries without any attribute data (the boundary of Austin, for example).
`tidyverse` is actually a collection of several packages such as `tidyr`, `dplyr`, and `ggplot2` that can be used for transforming, analyzing, and visualizing data.
`sf` is a package that allows essential GIS workflows to be executed in R.
`mapview` provides functions for generating interactive maps. Other packages exist for creating detailed maps, but this one is focused on creating quick and simple maps for data exploration.


## Importing data

### Census data with tidycensus
Before we import census data, it's often helpful to define what data we need and save them as variables in R that can be referenced later in our code.
```{r}
race_vars <- c(
  "% Hispanic or Latino" = "DP05_0073P",
  "% White" = "DP05_0079P",
  "% Black" = "DP05_0080P",
  "% AIAN" = "DP05_0081P",
  "% Asian" = "DP05_0082P",
  "% Pacific Islander" = "DP05_0083P",
  "% Other Race" = "DP05_0084P",
  "% Two or More Races" = "DP05_0085P"
)

austin_counties <- c("Travis", "Hays", "Williamson")
```


```{r}
#| output: false
austin_race <- get_acs(
  geography = "tract",
  variables = race_vars,
  year = 2022,
  output = "wide",
  state = "TX",
  county = austin_counties,
  geometry = TRUE,
  cb = FALSE
)
```


### Import geographies with tigris
```{r}
austin_boundary <- places(
  state = "TX"
)%>%
  filter(str_detect(NAME, "Austin"))

```

## Exploring the data

```{r}
glimpse(austin_race)
```

```{r}
view(austin_race)
```

```{r}
mapview(austin_race, zcol = "% Hispanic or LatinoE")
```


## Exporting shapefiles for ArcGIS
```{r}
#|eval: false
```




